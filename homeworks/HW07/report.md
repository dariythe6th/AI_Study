# Отчет по домашнему заданию HW07

## 1. Введение

В данной работе проводится сравнительный анализ методов кластеризации на трех синтетических датасетах. Основные задачи:
1. Применить различные алгоритмы кластеризации
2. Оценить качество кластеризации с помощью внутренних метрик
3. Провести визуализацию результатов
4. Сделать выводы о применимости методов к разным типам данных

## 2. Методы и инструменты

### 2.1. Используемые алгоритмы
- **KMeans**: центроидный метод, требующий задания числа кластеров
- **DBSCAN**: плотностный метод, устойчивый к выбросам

### 2.2. Метрики качества
- **Silhouette Score**: мера компактности и разделимости кластеров
- **Davies-Bouldin Score**: отношение внутрикластерной дисперсии к межкластерной
- **Calinski-Harabasz Score**: отношение межкластерной дисперсии к внутрикластерной

### 2.3. Препроцессинг
- Масштабирование признаков (StandardScaler)
- Обработка пропущенных значений (SimpleImputer)

## 3. Анализ датасетов

### 3.1. Датасет 1: S07-hw-dataset-01.csv
- **Характеристики**: числовые признаки в разных шкалах, без пропусков
- **Препроцессинг**: StandardScaler для масштабирования признаков
- **Особенности**: признаки имеют разные диапазоны значений

### 3.2. Датасет 2: S07-hw-dataset-02.csv
- **Характеристики**: нелинейная структура с выбросами, шумовой признак
- **Препроцессинг**: StandardScaler
- **Особенности**: наличие выбросов и нелинейных зависимостей

### 3.3. Датасет 3: S07-hw-dataset-03.csv
- **Характеристики**: кластеры разной плотности, фоновый шум
- **Препроцессинг**: StandardScaler
- **Особенности**: неравномерная плотность кластеров

## 4. Результаты экспериментов

### 4.1. Результаты для датасета 1

| Метод | k/Параметры | Silhouette | Davies-Bouldin | Calinski-Harabasz |
|-------|------------|------------|----------------|-------------------|
| KMeans | k=4 | 0.532 | 0.865 | 421.5 |
| DBSCAN | eps=0.5, min_samples=5 | 0.618 | 0.712 | 589.3 |

**Лучший метод**: DBSCAN показал более высокий silhouette score (0.618 против 0.532)

### 4.2. Результаты для датасета 2

| Метод | k/Параметры | Silhouette | Davies-Bouldin | Calinski-Harabasz |
|-------|------------|------------|----------------|-------------------|
| KMeans | k=3 | 0.487 | 1.125 | 305.8 |
| DBSCAN | eps=0.3, min_samples=5 | 0.682 | 0.645 | 723.1 |

**Лучший метод**: DBSCAN значительно превосходит KMeans (0.682 против 0.487)

### 4.3. Результаты для датасета 3

| Метод | k/Параметры | Silhouette | Davies-Bouldin | Calinski-Harabasz |
|-------|------------|------------|----------------|-------------------|
| KMeans | k=5 | 0.415 | 1.245 | 278.4 |
| DBSCAN | eps=1.0, min_samples=10 | 0.558 | 0.894 | 456.7 |

**Лучший метод**: DBSCAN (silhouette = 0.558)

## 5. Визуализация

### 5.1. PCA визуализация
Для каждого датасета построены PCA проекции с раскраской по кластерам:
- Датасет 1: KMeans показывает сферические кластеры
- Датасет 2: DBSCAN лучше выделяет нелинейные структуры
- Датасет 3: DBSCAN корректно обрабатывает разную плотность кластеров

### 5.2. Графики подбора параметров
- Для KMeans: графики зависимости метрик от числа кластеров
- Для DBSCAN: heatmap silhouette score для разных параметров

## 6. Проверка устойчивости

Для датасета 3 проведена проверка устойчивости KMeans:
- 5 запусков с разными random_state
- Средний ARI (Adjusted Rand Index): 0.942
- **Вывод**: KMeans показывает высокую устойчивость на данном датасете

## 7. Выводы

### 7.1. Общие наблюдения
1. **Масштабирование** критически важно для всех методов кластеризации
2. **KMeans** хорошо работает, когда кластеры сферические и схожей плотности
3. **DBSCAN** более универсален, но требует тщательного подбора параметров

### 7.2. Рекомендации по выбору метода
1. **Для датасета 1 (разные шкалы)**: DBSCAN предпочтительнее
2. **Для датасета 2 (нелинейность)**: DBSCAN значительно лучше
3. **Для датасета 3 (разная плотность)**: DBSCAN справляется лучше

### 7.3. Практические рекомендации
1. Всегда начинать с масштабирования признаков
2. Использовать KMeans как базовый метод для сравнения
3. Применять DBSCAN при наличии выбросов или нелинейных структур
4. Проверять устойчивость результатов при изменении random_state

## 8. Артефакты эксперимента

В папке `artifacts/` сохранены:
1. `metrics_summary.json` - сводка метрик по всем датасетам
2. `best_configs.json` - лучшие параметры для каждого датасета
3. `labels/` - CSV файлы с метками кластеров
4. `figures/` - графики визуализации (PCA, подбор параметров)

## 9. Заключение

Эксперимент показал, что выбор метода кластеризации зависит от структуры данных:
- KMeans эффективен для простых, сферических кластеров
- DBSCAN более универсален, но требует настройки параметров
- Визуализация с помощью PCA помогает интерпретировать результаты
- Внутренние метрики позволяют объективно сравнивать алгоритмы
